"""create all table

Revision ID: 57951b56149a
Revises: 
Create Date: 2022-06-09 17:23:56.760120

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = '57951b56149a'
down_revision = None
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('points',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False),
    sa.Column('name', sa.String(length=255), nullable=False),
    sa.Column('childs', sa.ARRAY(sa.String(length=200)), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_points_name'), 'points', ['name'], unique=True)
    op.create_table('routes',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False),
    sa.Column('name', sa.String(length=255), nullable=False),
    sa.Column('points', sa.ARRAY(sa.String(length=200)), nullable=True),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_routes_name'), 'routes', ['name'], unique=True)
    op.create_table('users',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False),
    sa.Column('name', sa.String(length=255), nullable=False),
    sa.Column('email', sa.String(length=255), nullable=False),
    sa.Column('password', sa.String(length=255), nullable=False),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_users_email'), 'users', ['email'], unique=False)
    op.create_index(op.f('ix_users_name'), 'users', ['name'], unique=True)
    op.create_table('user_routes',
    sa.Column('id', sa.BigInteger(), autoincrement=True, nullable=False),
    sa.Column('route_name', sa.String(length=255), nullable=False),
    sa.Column('passed_routes', sa.ARRAY(sa.String(length=200)), nullable=True),
    sa.Column('user_id', sa.BigInteger(), nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_index(op.f('ix_user_routes_route_name'), 'user_routes', ['route_name'], unique=True)
    op.create_index(op.f('ix_user_routes_user_id'), 'user_routes', ['user_id'], unique=False)
    op.execute(
        """
        INSERT INTO users(id, name, email, password)
        VALUES 
        (1, 'user1', 'test1@gmail.com', '$argon2id$v=19$m=65536,t=3,p=4$6BmjA4j5eVMnp9gRL/8nGA$7A7dBk+phUmdChoUKOAvdl5KWHXTwdbItRAFwb4njsY'),
        (2, 'user2', 'test2@gmail.com', '$argon2id$v=19$m=65536,t=3,p=4$f8/BZAiVTrENxUsbHmtcaw$HCd26aITBDBNu21XuMbdaJo0GJE+cc9TWk/v1EzMLyA'),
        (3, 'user3', 'test3@gmail.com', '$argon2id$v=19$m=65536,t=3,p=4$Bv6GidaAjV6j64T9gxGRpA$4NaPGKkQt5/qDbqkovUvVVpXriKZdf3g/I4UK+Qu4QI');
        """
    )
    op.execute(
        """
        INSERT INTO points(id, name, childs)
        VALUES 
            (1,'Almaty', ARRAY[2, 3]),
            (2,'Nur-sultan', ARRAY[1, 5]),
            (3,'Shimkent', ARRAY[1, 4]),
            (4,'Aktobe', ARRAY[6, 7]),
            (5,'Pavlodar', ARRAY[2]),
            (6,'Taraz', ARRAY[4]),
            (7,'Atyrau', ARRAY[4]);
        
        """
    )
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_index(op.f('ix_user_routes_user_id'), table_name='user_routes')
    op.drop_index(op.f('ix_user_routes_route_name'), table_name='user_routes')
    op.drop_table('user_routes')
    op.drop_index(op.f('ix_users_name'), table_name='users')
    op.drop_index(op.f('ix_users_email'), table_name='users')
    op.drop_table('users')
    op.drop_index(op.f('ix_routes_name'), table_name='routes')
    op.drop_table('routes')
    op.drop_index(op.f('ix_points_name'), table_name='points')
    op.drop_table('points')
    # ### end Alembic commands ###
